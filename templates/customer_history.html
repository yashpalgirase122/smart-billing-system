{% extends "base.html" %}
{% block content %}

<style>
  .profit { color: green; font-weight: bold; }
  .loss { color: red; font-weight: bold; }
</style>

<h2 style="margin-bottom:15px;">
  ðŸ§¾ Customer History : {{ customer }}
</h2>

<table class="table">
  <thead>
    <tr>
      <th>Date</th>
      <th>Product</th>
      <th>Qty</th>
      <th>Sell â‚¹</th>
      <th>Buy â‚¹</th>
      <th>Total â‚¹</th>
      <th>Profit â‚¹</th>
      <th>Outstanding â‚¹</th>
      <th>Status</th>
      <th>Action</th>
    </tr>
  </thead>

  <tbody>
  {% if history %}
    {% for row in history %}
    <tr>
      <td>{{ row.date }}</td>
      <td>{{ row.product }}</td>
      <td>{{ row.quantity }}</td>
      <td>â‚¹{{ row.sell_price }}</td>
      <td>â‚¹{{ row.buy_price }}</td>
      <td>â‚¹{{ row.total }}</td>

      <td class="{% if row.profit < 0 %}loss{% else %}profit{% endif %}">
        â‚¹{{ row.profit }}
      </td>

      <td>â‚¹{{ row.outstanding_balance }}</td>

      <td>
        {% if row.payment_status == 'Paid' %}
          <span style="color:green;font-weight:bold;">Paid</span>
        {% else %}
          <span style="color:red;font-weight:bold;">Unpaid</span>
        {% endif %}
      </td>

      <td>
        {% if row.payment_status == 'Unpaid' %}
          <a href="{{ url_for('update_payment', id=row.id, status='Paid') }}"
             class="btn btn-sm btn-success">
             Mark Paid
          </a>
        {% else %}
          â€”
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  {% else %}
    <tr>
      <td colspan="10" style="text-align:center;">
        No history found.
      </td>
    </tr>
  {% endif %}
  </tbody>
</table>

{% endblock %}
